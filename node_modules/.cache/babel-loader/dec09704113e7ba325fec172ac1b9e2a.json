{"ast":null,"code":"var _jsxFileName = \"/home/kelly/Springboard/exercises/react-jokes-classes/src/JokeList.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Joke from \"./Joke\";\nimport \"./JokeList.css\";\n\nclass JokeList extends Component {\n  // const [jokes, setJokes] = useState([]);\n  constructor(props) {\n    super(props);\n    this.state = {\n      jokes: []\n    };\n    this.generateNewJokes = this.generateNewJokes.bind(this);\n    this.resetVotes = this.resetVotes.bind(this);\n    this.toggleLock = this.toggleLock.bind(this);\n    this.vote = this.vote.bind(this);\n  }\n  /* get jokes if there are no jokes */\n\n\n  componentDidUpdate() {\n    if (!this.jokes) {\n      this.getJokes();\n    }\n  }\n\n  componentDidMount() {\n    if (this.state.jokes.length < this.props.numJokesToGet) this.getJokes();\n  } // useEffect(function() {\n\n\n  async getJokes() {\n    try {\n      let jokes = this.state.jokes;\n      let jokeObj = {\n        text: null,\n        votes: 0,\n        id: null,\n        locked: false\n      };\n      let seenJokes = new Set(jokes.map(j => j.id));\n      let jokeVotes = JSON.parse(window.localStorage.getItem(\"jokeVotes\") || \"{}\");\n\n      for (let i = 0; i < this.numJokesToGet; i++) {\n        let jokeRes = await axios.get(\"https://icanhazdadjoke.com\", {\n          headers: {\n            Accept: \"application/json\"\n          }\n        });\n        let {\n          status,\n          ...joke\n        } = jokeRes.data;\n\n        if (!seenJokes.joke.id) {\n          seenJokes.add(joke.id);\n          jokeVotes[joke.id] = jokeVotes[joke.id];\n          jokeObj.text = joke;\n          this.state.jokes.push(joke);\n        } else {\n          console.error(\"duplicate\");\n        }\n      }\n\n      this.setState({\n        jokes\n      });\n      window.localStorage.setItem(\"jokeVotes\", JSON.stringify(jokeVotes));\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  generateNewJokes() {\n    this.setState(st => ({\n      jokes: st.jokes.filter(j => j.locked)\n    }));\n  }\n\n  resetVotes() {\n    window.localStorage.setItem(\"jokeVotes\", \"{}\");\n    this.setState(st => ({\n      jokes: st.jokes.map(joke => ({ ...joke,\n        votes: 0\n      }))\n    }));\n  }\n  /* change vote for this id by delta (+1 or -1) */\n\n\n  vote(id, delta) {\n    let jokeVotes = JSON.parse(window.localStorage.getItem(\"jokeVotes\"));\n    jokeVotes[id] = (jokeVotes[id] || 0) + delta;\n    window.localStorage.setItem(\"jokeVotes\", JSON.stringify(jokeVotes));\n    this.setState(st => ({\n      jokes: st.jokes.map(j => j.id === id ? { ...j,\n        votes: j.votes + delta\n      } : j)\n    }));\n  }\n\n  toggleLock(id) {\n    this.setState(st => ({\n      jokes: st.jokes.map(j => j.id === id ? { ...j,\n        locked: !j.locked\n      } : j)\n    }));\n  }\n\n  render() {\n    let showJokes = [...this.state.jokes].sort((a, b) => b.votes - a.votes);\n    let allLocked = showJokes.filter(j => j.locked).length === this.props.numJokesToGet;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"JokeList\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"JokeList-getmore\",\n      onClick: this.generateNewJokes,\n      disabled: allLocked,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }\n    }, \"Get New Jokes\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"JokeList-getmore\",\n      onClick: this.resetVotes,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }\n    }, \"Reset Vote Counts\"), showJokes.map(j => /*#__PURE__*/React.createElement(Joke, {\n      text: j.text,\n      key: j.id,\n      id: j.id,\n      votes: j.votes,\n      vote: this.vote,\n      locked: j.locked,\n      toggleLock: this.toggleLock,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }\n    })), showJokes.length < this.props.numJokesToGet ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loading\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-4x fa-spinner fa-spin\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }\n    })) : null);\n  }\n\n}\n\nJokeList.defaultProps = {\n  numJokesToGet: 10\n};\nexport default JokeList;","map":{"version":3,"sources":["/home/kelly/Springboard/exercises/react-jokes-classes/src/JokeList.js"],"names":["React","Component","axios","Joke","JokeList","constructor","props","state","jokes","generateNewJokes","bind","resetVotes","toggleLock","vote","componentDidUpdate","getJokes","componentDidMount","length","numJokesToGet","jokeObj","text","votes","id","locked","seenJokes","Set","map","j","jokeVotes","JSON","parse","window","localStorage","getItem","i","jokeRes","get","headers","Accept","status","joke","data","add","push","console","error","setState","setItem","stringify","e","log","st","filter","delta","render","showJokes","sort","a","b","allLocked","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Joke from \"./Joke\";\nimport \"./JokeList.css\";\n\n\nclass JokeList extends Component {\n  static defaultProps = {\n    numJokesToGet: 10,\n  };\n\n  // const [jokes, setJokes] = useState([]);\n  constructor(props) {\n    super(props);\n    this.state = {\n      jokes: [],\n    };\n    this.generateNewJokes = this.generateNewJokes.bind(this);\n    this.resetVotes = this.resetVotes.bind(this);\n    this.toggleLock = this.toggleLock.bind(this);\n    this.vote = this.vote.bind(this);\n  }\n\n  /* get jokes if there are no jokes */\n  componentDidUpdate() {\n    if (!this.jokes) {\n      this.getJokes();\n    }\n  }\n\n  componentDidMount() {\n    if (this.state.jokes.length < this.props.numJokesToGet) this.getJokes();\n  }\n\n  // useEffect(function() {\n  async getJokes() {\n    try {\n      let jokes = this.state.jokes;\n      let jokeObj = {\n        text: null,\n        votes: 0,\n        id: null,\n        locked: false,\n      };\n      let seenJokes = new Set(jokes.map((j) => j.id));\n      let jokeVotes = JSON.parse(\n        window.localStorage.getItem(\"jokeVotes\") || \"{}\"\n      );\n\n      for (let i = 0; i < this.numJokesToGet; i++) {\n        let jokeRes = await axios.get(\"https://icanhazdadjoke.com\", {\n          headers: { Accept: \"application/json\" },\n        });\n\n        let { status, ...joke } = jokeRes.data;\n\n        if (!seenJokes.joke.id) {\n          seenJokes.add(joke.id);\n          jokeVotes[joke.id] = jokeVotes[joke.id];\n          jokeObj.text = joke;\n          this.state.jokes.push(joke);\n        } else {\n          console.error(\"duplicate\");\n        }\n      }\n\n      this.setState({ jokes });\n      window.localStorage.setItem(\"jokeVotes\", JSON.stringify(jokeVotes));\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  generateNewJokes() {\n    this.setState((st) => ({ jokes: st.jokes.filter((j) => j.locked) }));\n  }\n\n  resetVotes() {\n    window.localStorage.setItem(\"jokeVotes\", \"{}\");\n    this.setState((st) => ({\n      jokes: st.jokes.map((joke) => ({ ...joke, votes: 0 })),\n    }));\n  }\n\n  /* change vote for this id by delta (+1 or -1) */\n\n  vote(id, delta) {\n    let jokeVotes = JSON.parse(window.localStorage.getItem(\"jokeVotes\"));\n    jokeVotes[id] = (jokeVotes[id] || 0) + delta;\n    window.localStorage.setItem(\"jokeVotes\", JSON.stringify(jokeVotes));\n    this.setState((st) => ({\n      jokes: st.jokes.map((j) =>\n        j.id === id ? { ...j, votes: j.votes + delta } : j\n      ),\n    }));\n  }\n\n  toggleLock(id) {\n    this.setState((st) => ({\n      jokes: st.jokes.map((j) =>\n        j.id === id ? { ...j, locked: !j.locked } : j\n      ),\n    }));\n  }\n\n  render() {\n    let showJokes = [...this.state.jokes].sort((a, b) => b.votes - a.votes);\n    let allLocked =\n      showJokes.filter((j) => j.locked).length ===\n      this.props.numJokesToGet;\n    return (\n      <div className=\"JokeList\">\n        <button\n          className=\"JokeList-getmore\"\n          onClick={this.generateNewJokes}\n          disabled={allLocked}\n        >\n          Get New Jokes\n        </button>\n        <button className=\"JokeList-getmore\" onClick={this.resetVotes}>\n          Reset Vote Counts\n        </button>\n        {showJokes.map((j) => (\n          <Joke\n            text={j.text}\n            key={j.id}\n            id={j.id}\n            votes={j.votes}\n            vote={this.vote}\n            locked={j.locked}\n            toggleLock={this.toggleLock}\n          />\n        ))}\n        {showJokes.length < this.props.numJokesToGet ? (\n          <div className=\"loading\">\n            <i className=\"fas fa-4x fa-spinner fa-spin\" />\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nexport default JokeList;\n"]},"metadata":{},"sourceType":"module"}